# 工作区与功能包的创建

> 我做了一点处理，代码直接复制是没有用的捏 ^_^

## 创建功能包

### Step 1 确认当前位置

确认自己在`···/<自己工作区名字>/src`目录下

### Step 2 更新环境变量
执行下面的指令
```
source /opt/ros/humble/setup.zsh
```
>`source`命令的解释在`BeforeAny/Linux_readme.md`中
>
>ros2 的Setup 文件都是进性环境变量的修改，让你不用输入全部的路径就能使用到一些目录，比如ros2 本身的目录在`/opt/ros/humble/bin/ros2`,你可以输入下面的语句进行查看
```
where ros2
```

### Step 2 新建功能包
```[shell]
ros2 pkg create <你的功能包名字> --build-type ament_cmake --dependencies rclcpp
```
这一句会创建一个功能包，直观的体现为你的`src`目录下新增加了一个以`<你的功能包名字>`命名的文件夹，这就是你新创建的功能包

> 对命令的解释
>
>`--build-type ament_cmake` 是指定环境为`C++`,同时以cmake进行管理, ROS2官方支持两种语言：`C++`和`python`
>
>`--dependencies rclcpp` 是在此处预先添加依赖包 `rclcpp`,这个包是 `c++`编写`ros2` 节点的主要包,如果是`python`则是`rclpy`
### Step 3 HelloWorld
在`<你的功能包名字>/src`下新建文件 `main.cpp`,并且简单的编写一个HelloWorld程序

再`<你的功能包名字>`中打开`CMakeLists.txt` 在最后一句代码之前添加
```
add_executable(<可执行文件名字> src/main.cpp)
install(
  TARGETS     <可执行文件名字>
  DESTINATION lib/${PROJECT_NAME})
```

文件最后应该如下所示
```
add_executable(<可执行文件名字> src/main.cpp)
install(
  TARGETS     <可执行文件名字>
  DESTINATION lib/${PROJECT_NAME})

ament_package()
```

之后在目录`<你的工作区>`下执行`colcon build`,这里要注意，根据规范，不能再工作区目录下的任何地方进行构建

如果构建成功，应该会有以下内容：
```
Starting >>> test    
Finished <<< test                  

Summary: 1 package finished 
```

如果你执行的没有问题，那么这时候你的文件目录应该如下所示

```
.
├── build
├── install
├── log
└── src
    └── test
        ├── CMakeLists.txt
        ├── include
        │   └── test
        ├── package.xml
        └── src
            └── main.cpp
```

### Step 4 运行你的helloworld
之后执行下述命令
```
source install/setup.zsh
ros2 run 你的功能包名字 你的可执行文件名字
```

如
```
>> source install/setup.zsh
>> ros2 run test helloworld
# `test` 是我的包名，`helloworld`是我的可执行文件名字
<< helloworld
```